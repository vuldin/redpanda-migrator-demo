# Redpanda Migrator Configuration
# Demonstrates data, schema, offset, and compacted topic migration
# Uses standalone redpanda_migrator for continuous schema syncing

input:
  redpanda_migrator:
    # Source cluster (simulating Confluent Kafka)
    seed_brokers:
      - redpanda-source:9092

    # Topics to migrate (regex pattern)
    topics:
      - 'demo-.*'
    regexp_topics: true

    # Consumer group for migration process
    consumer_group: redpanda-migrator

    # Start from beginning to migrate all historical data
    start_from_oldest: true

    # Schema Registry migration (source)
    schema_registry:
      url: http://redpanda-source:8081

output:
  redpanda_migrator:
    # Target Redpanda cluster
    seed_brokers:
      - redpanda-target:9092

    # Max in-flight messages (1 for strict ordering)
    max_in_flight: 1

    # Target Schema Registry with continuous syncing
    schema_registry:
      url: http://redpanda-target:8081
      interval: 10s  # Continuously sync schemas every 10 seconds

    # Auto-create topics with matching partition counts and configurations
    # Includes cleanup.policy (compact, compact,delete, delete)

# HTTP server for metrics and health checks
http:
  enabled: true
  address: 0.0.0.0:4195
  root_path: /
  debug_endpoints: false

# Prometheus metrics
metrics:
  prometheus: {}
  mapping: |
    # Label the lag metric to identify source cluster
    meta label = if this == "redpanda_lag" { "source" }

# Logging
logger:
  level: INFO
  format: json
  add_timestamp: true
  static_fields:
    '@service': redpanda-migrator
